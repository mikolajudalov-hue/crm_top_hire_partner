{% extends "layout.html" %}
{% block content %}
<div class="card p-3">
  <div class="d-flex justify-content-between align-items-start">
    <div>
      <h2 class="hero-title mb-2">{{ job.title }}
        {% if job.priority=='urgent' %}<span class="badge text-bg-danger">üî• –°—Ä–æ—á–Ω–æ</span>
        {% elif job.priority=='low' %}<span class="badge text-bg-info">–ù–∏–∑–∫–∏–π</span>
        {% else %}<span class="badge text-bg-secondary">–û–±—ã—á–Ω–∞—è</span>{% endif %}
        {% if job.status == 'inactive' %}
          <span class="badge text-bg-light text-muted ms-1">–ù–µ –∞–∫—Ç—É–∞–ª—å–Ω–∞—è</span>
        {% endif %}
        {% if job.promo_multiplier and job.promo_multiplier > 1 %}
          <span class="badge text-bg-warning ms-1">‚ú® –ê–∫—Ü–∏—è x{{ job.promo_multiplier|round(2) }}</span>
        {% endif %}
      </h2>
      <p class="text-muted mb-1">{{ job.location }}</p>
      <p class="mb-1 small">
        {% if job.gender_preference %}
          –ü–æ–ª: {% if job.gender_preference == 'male' %}–º—É–∂—á–∏–Ω–∞{% elif job.gender_preference == 'female' %}–∂–µ–Ω—â–∏–Ω–∞{% else %}–ª—é–±–æ–π{% endif %}
          {% if job.age_to %} ¬∑ {% endif %}
        {% endif %}
        {% if job.age_to %}
          –≤–æ–∑—Ä–∞—Å—Ç –¥–æ {{ job.age_to }} –ª–µ—Ç
        {% endif %}
      </p>
      {% if job.short_description %}
      <p class="mb-1 text-body-secondary">{{ job.short_description }}</p>
      {% endif %}
      <p class="mb-2">{{ job.description }}</p>
      <p class="fw-semibold mb-1">–ö–æ–º–∏—Å—Å–∏—è –ø–∞—Ä—Ç–Ω—ë—Ä—É:
        {% if job.promo_multiplier and job.promo_multiplier > 1 %}
          <span class="text-decoration-line-through text-muted me-1">{{ job.partner_fee_amount }} PLN</span>
          <span>{{ (job.partner_fee_amount * job.promo_multiplier)|round(2) }} PLN</span>
        {% else %}
          <span>{{ job.partner_fee_amount }} PLN</span>
        {% endif %}
      </p>
      {% if job.promo_label %}
      <p class="mb-0 small text-warning-emphasis">üì¢ {{ job.promo_label }}</p>
      {% endif %}
    </div>
    <div class="d-flex flex-column align-items-end gap-2">
      <a class="btn btn-primary" href="{{ url_for('job_submit', job_id=job.id) }}">–ü–æ–¥–∞—Ç—å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞</a>
      {% if g.user.role in ['coordinator','recruiter'] %}
      <a class="btn btn-outline-primary btn-sm" href="{{ url_for('job_edit', job_id=job.id) }}">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
      {% endif %}
      {% if g.user.role == 'coordinator' %}
      <form method="post" action="{{ url_for('job_delete', job_id=job.id) }}" onsubmit="return confirm('–¢–æ—á–Ω–æ —É–¥–∞–ª–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é –∏ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.');">
        <button type="submit" class="btn btn-outline-danger btn-sm">–£–¥–∞–ª–∏—Ç—å –≤–∞–∫–∞–Ω—Å–∏—é</button>
      </form>
      {% endif %}
    </div>
  </div>
</div>

{% if g.user.role == 'coordinator' %}
<div class="card p-3 mt-3">
  <h5 class="mb-2">–ê–∫—Ü–∏—è –ø–æ –≤–∞–∫–∞–Ω—Å–∏–∏</h5>
  <form method="post" action="{{ url_for('job_promo_update', job_id=job.id) }}" class="row g-3 align-items-end">
    <div class="col-md-4">
      <label class="form-label">–ë—É—Å—Ç–µ—Ä –¥–ª—è –ø–∞—Ä—Ç–Ω—ë—Ä–∞</label>
      <select class="form-select" name="promo_multiplier">
        <option value="1.0" {% if not job.promo_multiplier or job.promo_multiplier <= 1 %}selected{% endif %}>–ë–µ–∑ –±—É—Å—Ç–µ—Ä–∞</option>
        <option value="1.2" {% if job.promo_multiplier == 1.2 %}selected{% endif %}>√ó1.2</option>
        <option value="1.5" {% if job.promo_multiplier == 1.5 %}selected{% endif %}>√ó1.5</option>
        <option value="2.0" {% if job.promo_multiplier == 2.0 %}selected{% endif %}>√ó2.0</option>
      </select>
    </div>
    <div class="col-md-6">
      <label class="form-label">–¢–µ–∫—Å—Ç –∞–∫—Ü–∏–∏</label>
      <input class="form-control" name="promo_label" value="{{ job.promo_label }}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –î–æ 31.12 √ó1.5 –∑–∞ —Å—Ç–∞—Ä—Ç">
    </div>
    <div class="col-md-2 d-grid">
      <button class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    </div>
  </form>
  <p class="small text-muted mt-2 mb-0">–í—Å–µ –Ω–æ–≤—ã–µ –ø–æ–¥–∞—á–∏ –±—É–¥—É—Ç —Å—á–∏—Ç–∞—Ç—å –∫–æ–º–∏—Å—Å–∏—é –ø–æ —Ç–µ–∫—É—â–µ–π –∞–∫—Ü–∏–∏. –£–∂–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç —Å–≤–æ—é —Å—É–º–º—É.</p>
</div>
{% endif %}

{% endblock %}
